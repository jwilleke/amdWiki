---
title: CounterPlugin
uuid: 967ba551-3330-43f5-aceb-575881cba683
system-category: developer
user-keywords: []
slug: counterplugin
lastModified: '2025-10-19T11:25:00.000Z'
author: system
---
# CounterPlugin Documentation

The CounterPlugin is a JSPWiki-compatible plugin that maintains page-specific counters for numbering items, tracking invocations, and implementing sequential logic. Unlike a persistent hit counter, CounterPlugin tracks values within a single page render cycle.

## Overview

Similar to [JSPWiki's Counter plugin](https://jspwiki-wiki.apache.org/Wiki.jsp?page=Counter), this plugin allows you to:
- Create sequential numbering (1, 2, 3, ...)
- Maintain multiple named counters on one page
- Increment by custom values (including negative for countdown)
- Reset counters to specific values
- Hide counter output while still incrementing
- Access counter values as variables without incrementing

**Related:** GitHub Issue #134

## Important: Counter Behavior

**Counters reset on every page render/reload.** This is the correct JSPWiki-compatible behavior:

- ✅ Counters are per-render, not persistent
- ✅ Each page view starts fresh from 0
- ✅ Different users see independent counters
- ✅ Refreshing the page resets all counters

**Use Case:** Counters are for numbering items within a page (like figures, sections, or list items), NOT for tracking page views across multiple visits.

## Syntax

```
[{Counter}]
[{Counter parameter=value ...}]
```

## Parameters

| Parameter | Type | Description | Default |
|-----------|------|-------------|---------|
| `name` | string | Distinguishes multiple counters on one page | `counter` |
| `increment` | number | Amount to add to counter (can be negative) | `1` |
| `start` | number | Resets counter to specified value | (none) |
| `showResult` | boolean | Controls whether counter value is displayed | `true` |

## Usage Examples

### Basic Sequential Numbering

Number items sequentially:

```
Item [{Counter}]: First item
Item [{Counter}]: Second item
Item [{Counter}]: Third item
```

**Output:**
```
Item 1: First item
Item 2: Second item
Item 3: Third item
```

**Live Example:**

Item [{Counter}]: First item
Item [{Counter}]: Second item
Item [{Counter}]: Third item

### Multiple Named Counters

Maintain separate counters for different purposes:

```
Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]
Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]
Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]
```

**Output:**
```
Chapter 1, Section 1
Chapter 2, Section 2
Chapter 3, Section 3
```

**Live Example:**

Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]
Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]
Chapter [{Counter name='chapter'}], Section [{Counter name='section'}]

### Starting from a Specific Value

Begin counting at a custom number:

```
[{Counter start='100'}]
[{Counter}]
[{Counter}]
```

**Output:**
```
100
101
102
```

**Live Example:**

[{Counter start='100'}]
[{Counter}]
[{Counter}]

### Custom Increment Steps

Count by values other than 1:

```
[{Counter name='even' increment='2'}]
[{Counter name='even' increment='2'}]
[{Counter name='even' increment='2'}]
```

**Output:**
```
2
4
6
```

**Live Example:**

[{Counter name='even' increment='2'}]
[{Counter name='even' increment='2'}]
[{Counter name='even' increment='2'}]

### Countdown with Negative Increment

Count backwards:

```
[{Counter name='countdown' start='10'}]
[{Counter name='countdown' increment='-1'}]
[{Counter name='countdown' increment='-1'}]
[{Counter name='countdown' increment='-1'}]
```

**Output:**
```
10
9
8
7
```

**Live Example:**

[{Counter name='countdown' start='10'}]
[{Counter name='countdown' increment='-1'}]
[{Counter name='countdown' increment='-1'}]
[{Counter name='countdown' increment='-1'}]

### Hidden Counter Increment

Increment silently without displaying:

```
[{Counter showResult='false'}]
[{Counter showResult='false'}]
[{Counter showResult='false'}]
The counter is now at: [{$counter}]
```

**Output:**
```
The counter is now at: 3
```

**Live Example:**

[{Counter showResult='false'}]
[{Counter showResult='false'}]
[{Counter showResult='false'}]
The counter is now at: [{$counter}]

### Accessing Counter as Variable

Read counter value without incrementing:

```
[{Counter}]
[{Counter}]
Current value: [{$counter}]
[{Counter}]
Final value: [{$counter}]
```

**Output:**
```
1
2
Current value: 2
3
Final value: 3
```

**Live Example:**

[{Counter}]
[{Counter}]
Current value: [{$counter}]
[{Counter}]
Final value: [{$counter}]

### Named Counter Variables

Access named counters as variables:

```
[{Counter name='fig'}]
[{Counter name='table'}]
Figure [{$counter-fig}], Table [{$counter-table}]
```

**Output:**
```
1
1
Figure 1, Table 1
```

**Live Example:**

[{Counter name='fig'}]
[{Counter name='table'}]
Figure [{$counter-fig}], Table [{$counter-table}]

## Practical Use Cases

### Figure Numbering

```
![Graph](graph.png)
**Figure [{Counter name='figure'}]:** Monthly sales data

![Chart](chart.png)
**Figure [{Counter name='figure'}]:** Yearly trends
```

### Hierarchical Numbering

```
# Section [{Counter name='section'}]
## Subsection [{Counter name='section'}].1
## Subsection [{Counter name='section'}].2

# Section [{Counter name='section'}]
[{Counter name='subsection' start='1' showResult='false'}]
## Subsection [{Counter name='section'}].1
## Subsection [{Counter name='section'}].2
```

### Custom Ordered Lists

```
[{Counter start='1'}]. Introduction and background
[{Counter}]. Research methodology
[{Counter}]. Results and findings
[{Counter}]. Conclusions
```

### Progress Tracking

```
[{Counter showResult='false'}]
[{Counter showResult='false'}]
[{Counter showResult='false'}]
Progress: [{$counter}]/10 steps completed ([{Counter showResult='false'}][{Counter showResult='false'}][{$counter}]/10)
```

## Technical Details

### Counter Storage

- Counters are stored in the page rendering context
- Each counter uses the key format:
  - Default counter: `counter`
  - Named counters: `counter-{name}`
- Counters persist only for the duration of a single page render
- Each page view creates a fresh counter context

### Counter Initialization

- Counters start at 0 and increment to 1 on first use
- The `start` parameter overrides increment behavior
- When `start` is specified, the counter is set to that exact value
- Subsequent calls without `start` resume normal incrementing

### Parameter Precedence

1. If `start` is specified, it sets the counter value (ignoring current value)
2. If `start` is not specified, `increment` is applied to current value
3. `showResult` controls output but doesn't affect counter value
4. All parameters can be combined (except `start` overrides increment logic)

### Variable Access

Counter values can be accessed as wiki variables:

- `[{$counter}]` - Default counter value
- `[{$counter-name}]` - Named counter value

**Important:** Variable access reads the current value WITHOUT incrementing it.

## Advanced Tips

### 1. Resetting Mid-Sequence

Reset a counter back to a specific value:

```
[{Counter}]
[{Counter}]
[{Counter start='1'}]
[{Counter}]
```

Output: `1 2 1 2`

### 2. Multiple Independent Sequences

Maintain several counting sequences simultaneously:

```
Figure [{Counter name='fig'}], Table [{Counter name='tbl'}], Example [{Counter name='ex'}]
Figure [{Counter name='fig'}], Table [{Counter name='tbl'}], Example [{Counter name='ex'}]
```

### 3. Conditional Numbering

Use hidden counters for complex numbering:

```
[{Counter name='total' showResult='false'}]
Item [{Counter name='visible'}] of [{$counter-total}]
[{Counter name='total' showResult='false'}]
Item [{Counter name='visible'}] of [{$counter-total}]
```

### 4. Decimal Increments

Use decimal values for sub-numbering:

```
[{Counter name='version' start='1.0'}]
[{Counter name='version' increment='0.1'}]
[{Counter name='version' increment='0.1'}]
```

Output: `1.0 1.1 1.2`

## Comparison with JSPWiki

### JSPWiki Counter Plugin

JSPWiki's Counter supports:
- `name` - Named counters
- `increment` - Custom increment value
- `start` - Reset to specific value
- `showResult` - Hide/show output

### amdWiki CounterPlugin

Our implementation is **100% compatible** with JSPWiki:
- ✅ All JSPWiki parameters supported
- ✅ Same counter behavior (per-render)
- ✅ Same variable access pattern (`[{$counter}]`)
- ✅ Same naming convention (`counter-{name}`)
- ✅ Negative increments supported
- ✅ Decimal values supported

## Common Issues

### Counter Doesn't Persist Across Page Reloads

**This is correct behavior!** Counters are designed to be per-render, not persistent.

**Explanation:** Each time a page is rendered (including reloads), counters start fresh from 0. This is how JSPWiki's Counter works and is intentional.

**If you need persistent counting:**
- Use a different mechanism (database, file storage, etc.)
- Consider if you actually need page view tracking instead

### Counter Shows Wrong Value

**Check these common issues:**

1. **Multiple counters with same name** - Each `name` creates a separate counter
2. **Start parameter used** - `start` resets the counter to that value
3. **Hidden increments** - Check for `showResult='false'` calls
4. **Variable timing** - Variables show current value at that point in rendering

### Counter Not Appearing in Output

**Solutions:**

1. Check `showResult` parameter isn't set to `false`
2. Verify plugin syntax: `[{Counter}]` not `[Counter]` or `{Counter}`
3. Check for typos in parameter names
4. Look for the value - it might be there but unexpected

## Configuration

CounterPlugin is automatically loaded by PluginManager. No additional configuration is required.

The plugin uses these configuration paths:

```json
{
  "amdwiki.managers.pluginManager.enabled": true,
  "amdwiki.managers.pluginManager.searchPaths": [
    "./plugins"
  ]
}
```

## See Also

- [Plugin System Documentation](plugin-system-documentation) - How plugins work in amdWiki
- [Platform Variables](platform-variables) - System variables and VariablesPlugin
- [JSPWiki Counter](https://jspwiki-wiki.apache.org/Wiki.jsp?page=Counter) - Original JSPWiki Counter documentation
- [PluginManager Developer Docs|https://github.com/jwilleke/amdWiki/blob/master/src/managers/PluginManager.js|target='_blank'] - Technical implementation

## Related Issues

- GitHub Issue #134 - CounterPlugin implementation

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0.0 | 2025-10-19 | Initial implementation with full JSPWiki compatibility |

---

**Last Updated:** 2025-10-19
**Plugin Location:** `/plugins/CounterPlugin.js`
**Status:** Active ✅
