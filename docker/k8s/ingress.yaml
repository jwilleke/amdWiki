# amdWiki Kubernetes Ingress
# Deploy with: kubectl apply -f ingress.yaml
#
# Prerequisites:
# - Ingress controller (nginx-ingress, traefik, etc.)
# - TLS certificate (cert-manager recommended)
#
# For cert-manager with Let's Encrypt:
#   kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.0/cert-manager.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: amdwiki
  labels:
    app: amdwiki
    app.kubernetes.io/name: amdwiki
  annotations:
    # NGINX Ingress annotations
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"

    # Uncomment for cert-manager TLS
    # cert-manager.io/cluster-issuer: letsencrypt-prod

    # Uncomment to force HTTPS redirect
    # nginx.ingress.kubernetes.io/ssl-redirect: "true"
spec:
  # Uncomment for TLS
  # tls:
  #   - hosts:
  #       - wiki.example.com
  #     secretName: amdwiki-tls
  rules:
    - host: wiki.example.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: amdwiki
                port:
                  number: 80
---
# Optional: ClusterIssuer for Let's Encrypt
# Requires cert-manager to be installed
# apiVersion: cert-manager.io/v1
# kind: ClusterIssuer
# metadata:
#   name: letsencrypt-prod
# spec:
#   acme:
#     server: https://acme-v02.api.letsencrypt.org/directory
#     email: your-email@example.com
#     privateKeySecretRef:
#       name: letsencrypt-prod
#     solvers:
#       - http01:
#           ingress:
#             class: nginx
