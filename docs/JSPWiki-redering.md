# Apache JSPWiki rendering 
Apache JSPWiki renders pages using a series of Java components orchestrated by its wiki engine. Below is a concise explanation of the page rendering process, focusing on the key Java components involved, including `RenderingManager`, based on the JSPWiki architecture and the provided GitHub repository information (commit `c31d4f284983fd25e37e7ec5682fe2bdfddc439b`).

1. **Request Handling**:
   - **Component**: `WikiServlet` (or equivalent servlet defined in `WEB-INF/web.xml`).
   - **Role**: The servlet container (e.g., Apache Tomcat) receives the HTTP request (e.g., `http://<host>/<appname>/Wiki.jsp?page=PageName`) and routes it to JSPWiki’s servlet. This servlet initializes the `WikiEngine` for processing.

2. **WikiEngine Initialization**:
   - **Component**: `org.apache.wiki.WikiEngine`.
   - **Role**: The `WikiEngine` is the central component that coordinates page rendering. It initializes other managers, including `RenderingManager`, and retrieves the requested page’s context (e.g., page name, user session).
   - **Configuration**: Uses settings from `jspwiki.properties` or `jspwiki-custom.properties` (located in `$TOMCAT_HOME/lib` or `WEB-INF`).

3. **Page Retrieval**:
   - **Component**: `PageManager` and `PageProvider` (e.g., `org.apache.wiki.providers.FileSystemProvider`).
   - **Role**: The `PageManager` retrieves the page content via a `PageProvider`. The default `FileSystemProvider` reads the page’s raw wiki markup from the directory specified in `jspwiki.fileSystemProvider.pageDir`.
   - **Interaction**: `WikiEngine` delegates to `PageManager`, which uses the provider to fetch the page as a `WikiPage` object.

4. **Parsing and Rendering**:
   - **Component**: `RenderingManager` ( `org.apache.wiki.render.RenderingManager`).
   - **Role**: Manages the rendering pipeline, converting wiki markup into HTML. It coordinates:
     - **WikiParser**: Parses the raw wiki markup (e.g., `[[PageName]]` for links, `**bold**` for formatting) into an intermediate representation.
     - **MarkupRenderer**: Converts the parsed markup into HTML, applying styles and templates.
     - **FilterManager**: Applies filters (e.g., `org.apache.wiki.filters.WikiFilter`) to preprocess or postprocess content, such as handling plugins or custom syntax.
   - **Plugins**: `RenderingManager` integrates plugins (via `PluginManager`) to embed dynamic content during rendering.
   - **Output**: Produces HTML output for the page content.

5. **Access Control**:
   - **Component**: `AuthorizationManager` and `AuthenticationManager`.
   - **Role**: `AuthorizationManager` checks permissions using JAAS and the `WEB-INF/jspwiki.policy` file to ensure the user has access to view the page. `AuthenticationManager` handles user authentication, referencing `jspwiki.xmlUserDatabaseFile` and `jspwiki.xmlGroupDatabaseFile`.
   - **Interaction**: `WikiEngine` consults these managers before rendering to enforce security.

6. **Template Rendering**:
   - **Component**: JSP files (e.g., `Wiki.jsp`, `ViewTemplate.jsp`) and `TemplateManager`.
   - **Role**: The `TemplateManager` integrates the HTML output from `RenderingManager` into a JSP-based template, which defines the page layout (e.g., headers, footers, navigation). The JSP files, executed by the servlet container, combine the rendered content with the template.
   - **Configuration**: Templates can be customized via `jspwiki-custom.properties`.

7. **Output Delivery**:
   - **Component**: Servlet container and `WikiServlet`.
   - **Role**: The servlet container sends the final HTML response (generated by JSP files) to the client’s browser. Caching may be applied via `CacheManager` (configurable in `jspwiki.properties`) to optimize performance.

8. **Optional Components**:
   - **PluginManager** ( `org.apache.wiki.plugin.PluginManager`): Handles execution of wiki plugins during rendering, allowing dynamic content (e.g., tables, charts) to be embedded by `RenderingManager`.
   - **AttachmentManager**: Manages attachments (stored in `jspwiki.basicAttachmentProvider.storageDir`), rendering links to them in the page if applicable.

**Summary of Key Java Components**:
- `WikiEngine`: Orchestrates the rendering process.
- `PageManager`/`PageProvider`: Retrieves page content.
- `RenderingManager`: Converts wiki markup to HTML, coordinating parsing and filtering.
- `AuthorizationManager`/`AuthenticationManager`: Enforce access control.
- `TemplateManager`: Integrates content into JSP templates.
- `PluginManager`: Handles dynamic content via plugins.
- `AttachmentManager`: Manages attachment rendering.

For further details, refer to the JSPWiki source code in the `org.apache.wiki` package or the documentation at https://jspwiki.apache.org.