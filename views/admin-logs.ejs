<%- include('header', { title: 'System Logs' }) %>

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-file-alt"></i> System Logs</h1>
        <a href="/admin" class="btn" style="background-color: var(--btn-secondary-bg); color: var(--btn-secondary-text); border-color: var(--btn-secondary-border);">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
      </div>

      <% if (typeof successMessage !== 'undefined' && successMessage) { %>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          <i class="fas fa-check-circle"></i> <%= successMessage %>
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      <% } %>

      <% if (typeof errorMessage !== 'undefined' && errorMessage) { %>
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
          <i class="fas fa-exclamation-triangle"></i> <%= errorMessage %>
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      <% } %>

      <!-- Log Files -->
      <div class="card mb-4">
        <div class="card-header">
          <h5><i class="fas fa-folder-open"></i> Available Log Files</h5>
        </div>
        <div class="card-body">
          <% if (logFiles && logFiles.length > 0) { %>
            <div class="list-group" style="max-height: 300px; overflow-y: auto;">
              <% logFiles.forEach(file => { %>
                <a href="/admin/logs?file=<%= encodeURIComponent(file.name) %>"
                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center <%= selectedFile === file.name ? 'active' : '' %>">
                  <span>
                    <i class="fas fa-file-alt"></i> <%= file.name %>
                  </span>
                  <span class="text-muted small">
                    <%= (file.size / 1024).toFixed(1) %> KB
                    <span class="ms-2"><%= new Date(file.mtime).toLocaleDateString() %></span>
                  </span>
                </a>
              <% }); %>
            </div>
          <% } else { %>
            <p class="text-muted">No log files found.</p>
          <% } %>
        </div>
      </div>

      <!-- Recent Logs -->
      <div class="card">
        <div class="card-header">
          <h5><i class="fas fa-list"></i> Log Content: <%= selectedFile || 'No file selected' %> <small class="text-muted">(Last 100 lines)</small></h5>
        </div>
        <div class="card-body">
          <pre style="background-color: var(--pre-bg, #f8f9fa); color: var(--pre-text, #212529); padding: 15px; border-radius: 5px; max-height: 600px; overflow-y: auto; border: 1px solid var(--border-color, #dee2e6);"><%= logContent || 'No log content available' %></pre>
        </div>
      </div>

      <div class="mt-3">
        <button class="btn" style="background-color: var(--btn-primary-bg); color: var(--btn-primary-text); border-color: var(--btn-primary-border);" onclick="location.reload()">
          <i class="fas fa-sync"></i> Refresh Logs
        </button>
      </div>
    </div>
  </div>
</div>

<%- include('footer') %>
