
<%- include('header', { pageName: pageName }) %>

<!-- Page content -->
<div class="markdown-body mb-4">
    <%- content %>
</div>

<!-- Page Metadata section -->
<% if (typeof metadata !== 'undefined' && metadata) { %>
<div class="card mb-4">
    <div class="card-header">
        <h6 class="mb-0">
            <i class="fas fa-info-circle"></i> Page Information
        </h6>
    </div>
    <div class="card-body">
        <div class="row small">
            <div class="col-md-6">
                <% if (metadata.creator) { %>
                <p class="mb-1"><strong>Creator:</strong> <%= metadata.creator %></p>
                <% } %>
                <% if (metadata.editor) { %>
                <p class="mb-1"><strong>Last Editor:</strong> <%= metadata.editor %></p>
                <% } %>
                <% if (metadata.lastModified) { %>
                <p class="mb-1"><strong>Last Modified:</strong> <%= new Date(metadata.lastModified).toLocaleString() %></p>
                <% } %>
            </div>
            <div class="col-md-6">
                <% if (metadata['system-category']) { %>
                <p class="mb-1"><strong>Category:</strong> <span class="badge bg-primary"><%= metadata['system-category'] %></span></p>
                <% } %>
                <% if (metadata['user-keywords'] && metadata['user-keywords'].length > 0) { %>
                <p class="mb-1"><strong>Keywords:</strong>
                    <% metadata['user-keywords'].forEach(keyword => { %>
                        <span class="badge bg-secondary me-1"><%= keyword %></span>
                    <% }); %>
                </p>
                <% } %>
            </div>
        </div>
    </div>
</div>
<% } %>

<!-- More Information section (similar to JSPWiki) -->
<% if (referringPages && referringPages.length > 0) { %>
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">
            <i class="fas fa-sitemap"></i> More Information
        </h5>
    </div>
    <div class="card-body">
        <p class="text-muted">There might be more information for this subject on one of the following:</p>
        <ul class="list-unstyled">
            <% referringPages.forEach(page => { %>
                <li class="mb-1">
                    <i class="fas fa-link"></i> 
                    <a href="/wiki/<%= page %>"><%= page %></a>
                </li>
            <% }); %>
        </ul>
    </div>
</div>
<% } %>

<script>
function deletePage(pageName) {
    if (confirm('Are you sure you want to delete this page?')) {
        fetch(`/delete/${encodeURIComponent(pageName)}`, {
            method: 'DELETE'
        }).then(response => {
            if (response.ok) {
                window.location.href = '/';
            } else {
                alert('Error deleting page');
            }
        });
    }
}
</script>

<%- include('footer') %>
