
<%- include('header') %>

<!-- Page header with actions -->
<h1 class="h2"><%= pageName %></h1>
<div class="btn-toolbar mb-3">
    <div class="btn-group mr-2">
        <% if (currentUser && currentUser.isAuthenticated) { %>
            <% if (canEdit) { %>
                <a href="/edit/<%= pageName %>" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-edit"></i> Edit
                </a>
            <% } %>
            <% if (canDelete) { %>
                <button class="btn btn-sm btn-outline-danger" onclick="deletePage('<%= pageName %>')">
                    <i class="fas fa-trash"></i> Delete
                </button>
            <% } %>
        <% } %>
        <a href="/wiki/<%= pageName %>" class="btn btn-sm btn-outline-secondary">
            <i class="fas fa-info-circle"></i> Info
        </a>
    </div>
</div>

<!-- Page content -->
<div class="markdown-body mb-4">
    <%- content %>
</div>

<!-- More Information section (similar to JSPWiki) -->
<% if (referringPages && referringPages.length > 0) { %>
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">
            <i class="fas fa-sitemap"></i> More Information
        </h5>
    </div>
    <div class="card-body">
        <p class="text-muted">There might be more information for this subject on one of the following:</p>
        <ul class="list-unstyled">
            <% referringPages.forEach(page => { %>
                <li class="mb-1">
                    <i class="fas fa-link"></i> 
                    <a href="/wiki/<%= page %>"><%= page %></a>
                </li>
            <% }); %>
        </ul>
    </div>
</div>
<% } %>
            <!-- Page header with actions -->
            <h1 class="h2"><%= pageName %></h1>
            <div class="btn-toolbar mb-3">
                <div class="btn-group mr-2">
                    <% if (currentUser && currentUser.isAuthenticated) { %>
                        <% if (canEdit) { %>
                            <a href="/edit/<%= pageName %>" class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                        <% } %>
                        <% if (canDelete) { %>
                            <button class="btn btn-sm btn-outline-danger" onclick="deletePage('<%= pageName %>')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        <% } %>
                    <% } %>
                    <a href="/wiki/<%= pageName %>" class="btn btn-sm btn-outline-secondary">
                        <i class="fas fa-info-circle"></i> Info
                    </a>
                </div>
            </div>

            <!-- Page content -->
            <div class="markdown-body mb-4">
                <%- content %>
            </div>

            <!-- More Information section (similar to JSPWiki) -->
            <% if (referringPages && referringPages.length > 0) { %>
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-sitemap"></i> More Information
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted">There might be more information for this subject on one of the following:</p>
                    <ul class="list-unstyled">
                        <% referringPages.forEach(page => { %>
                            <li class="mb-1">
                                <i class="fas fa-link"></i> 
                                <a href="/wiki/<%= page %>"><%= page %></a>
                            </li>
                        <% }); %>
                    </ul>
                </div>
            </div>
            <% } %>
<script>
function deletePage(pageName) {
    if (confirm('Are you sure you want to delete this page?')) {
        fetch(`/delete/${encodeURIComponent(pageName)}`, {
            method: 'DELETE'
        }).then(response => {
            if (response.ok) {
                window.location.href = '/';
            } else {
                alert('Error deleting page');
            }
        });
    }
}
</script>

<%- include('footer') %>
